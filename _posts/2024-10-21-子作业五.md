---
title: "数字信号处理-子作业五"
date: 2024-10-21
---

# 一、要求
在子作业 4 的基础上，采用 MATLAB 的 filterDesigner 或 fdatool 工具箱，设计出相应的 IIR 滤波器和 FIR 滤波器。
# 二、实现思路
## 1.FIR 滤波器设计实现
由于在子作业四中只讨论了 IIR 滤波器参数的获取，故 FIR 滤波器的参数可利用子作业二中得到的参数，再利用 MATLAB 滤波器工具箱，输入截止频率 fc 选择合适的窗函数设计得到FIR 滤波器。
## 2.IIR 滤波器设计实现
根据子作业四得到的性能指标，利用 MATLAB 滤波器工具箱，输入性能指标参数选择效果最好的 IIR 滤波器进行滤波。
# 三、实现过程
## 1.性能指标分析
数字滤波器的频率响应表示为：$$H\left(\mathrm{e}^{j \omega}\right)=\left|H\left(\mathrm{e}^{j \omega}\right)\right| e^{j \beta(j \omega)}$$  
根据下图中理想低通滤波器逼近的误差容限可以看出，频率响应有通带、过渡带、阻带三个范围：  
![图 1 低通滤波器](https://github.com/yuzhu-like/skills-github-pages/blob/my-pages/filter.png)  
下图展示了不同滤波器的技术指标：  
![图 2 不同滤波器的技术指标](https://github.com/yuzhu-like/skills-github-pages/blob/my-pages/norm.png)  
所以依据子作业四得到的性能指标通带截止频率ωp=7.76kHz，阻带截止频率ωs=8kHz，通带最大衰减δ1=2dB，阻带最小衰减δ2=30dB，到滤波器阶数 N=43，3dB 截止频率ωc=7.7805kHz。可以使用 MATLAB 滤波器工具箱进行 IIR 滤波器的设计。  
依据子作业二的指标经过多次测试，发现设置 3000 阶的幅值 3dB 衰减对应频率在7.99kHz 时效果较好，可以使用 MATLAB 滤波器工具箱进行 FIR 滤波器的设计。  
## 2.FIR 滤波器设计实现
FilterDesign 设计如下图所示：  
![图 3 FIR 滤波器的设计](https://github.com/yuzhu-like/skills-github-pages/blob/my-pages/design.png)  
然后将设计好的滤波器导出 matlab 中：以.m 文件的形式导出到 matlab 中，方法是：点击 file，然后选择 Generate MATLAB Code -> Filter DesignFunction：注意要导出函数形式，否则会影响下一步，导出的函数代码如下：  


function Hd = myfir  
% MYFIR Returns a discrete-time filter object. % MATLAB Code  
% Generated by MATLAB(R) 9.2 and the Signal Processing Toolbox 7.4. % Generated on: 23-May-2023 20:44:39  
% FIR Window Lowpass filter designed using the FIR1 function. % All frequency values are in Hz. Fs = 22050; % Sampling Frequency  
N = 3000; % Order  
Fc = 7990; % Cutoff Frequency  
flag = 'scale'; % Sampling Flag  
% Create the window vector for the design algorithm. win = hamming(N+1);  
% Calculate the coefficients using the FIR1 function. b = fir1(N, Fc/(Fs/2), 'low', win, flag);  
Hd = dfilt.dffir(b);  
% [EOF]  


利用设计好的滤波器函数可以直接滤波，代码如下：  


clear;  
%声音信号的采样  
[x,Fs] = audioread('D:\桌面\音频.wav');  
x=x.';  
n=length(x);%获取 x 的采样点数  
dt=1/Fs;%求采样间隔  
time=(0:n-1)*dt;%采样时间点  
subplot(2,2,1);  
plot(time,x);  
title('原始声音信号时域波形')  
xlabel('时间/s');  
%原始信号 fft 变换  
f_true=time*Fs/length(time);  
k=fft(x,length(time));  
k(:,ceil(length(k)/2):end) = [];%去掉快速傅里叶变换对称的一半  
l=f_true*Fs/1e3;  
l(:,ceil(length(l)/2):end) = [];%去掉快速傅里叶变换对称的一半;  
subplot(2,2,2);  
plot(l,abs(k));title('原始声音信号频域图');xlabel('kHz');  
%FIR 滤波器(汉林窗)设计  
y = filter(myfir,x); % 直接使用设计好的滤波器进行滤波，filter 函数是滤波函数  
subplot(2,2,3);  
plot(time,y);  
title('FIR 滤波器(汉林窗)滤波后声音信号时域波形')  
xlabel('时间/s');  
%滤波后信号 fft 变换  
f_true=time*Fs/length(time);  
k=fft(y,length(time));  
k(:,ceil(length(k)/2):end) = [];%去掉快速傅里叶变换对称的一半  
l=f_true*Fs/1e3;  
l(:,ceil(length(l)/2):end) = [];%去掉快速傅里叶变换对称的一半  
subplot(2,2,4);  
plot(l,abs(k));title('FIR 滤波器(汉林窗)滤波后声音信号傅里叶变换');  
xlabel('kHz');  
%试听和写入信号  
audiowrite('D:\桌面\fir_filterDesign.wav',y,Fs);  

## 3.IIR滤波器设计实现
采用 MATLAB 的滤波器设计工具进行设计，在尝试不同种类的滤波器后，对比发现巴特沃斯滤波器的效果最佳，因此选择该滤波器来滤除噪声信号，设计得到的 IIR 滤波器结果如下图所示：  
![图 4 IIR 滤波器的设计](https://github.com/yuzhu-like/skills-github-pages/blob/my-pages/IIR.png)  
然后将设计好的滤波器导出 matlab 中：以.m 文件的形式导出到 matlab 中，方法是：点击 file，然后选择 Generate MATLAB Code -> Filter DesignFunction：注意要导出函数形式，否则会影响下一步，导出的函数代码如下：
function Hd = myiir  
%MYIIR Returns a discrete-time filter object.  
% MATLAB Code  
% Generated by MATLAB(R) 9.2 and the Signal Processing Toolbox 7.4.  
% Generated on: 23-May-2023 21:15:31  
% Butterworth Lowpass filter designed using FDESIGN.LOWPASS.  
% All frequency values are in Hz.  
Fs = 22050; % Sampling Frequency  
Fpass = 7760; % Passband Frequency  
Fstop = 8000; % Stopband Frequency  
Apass = 2; % Passband Ripple (dB)  
Astop = 30; % Stopband Attenuation (dB)  
match = 'stopband'; % Band to match exactly  
% Construct an FDESIGN object and call its BUTTER method. h = fdesign.lowpass(Fpass, Fstop, Apass, Astop, Fs);  
Hd = design(h, 'butter', 'MatchExactly', match);  
% [EOF]  
利用设计好的滤波器函数可以直接滤波，代码如下：  
clear;  
%声音信号的采样  
[x,Fs] = audioread('D:\桌面\音频.wav');  
x=x.';  
n=length(x);%获取 x 的采样点数  
dt=1/Fs;%求采样间隔  
time=(0:n-1)*dt;%采样时间点  
subplot(2,2,1);  
plot(time,x);  
title('原始声音信号时域波形')  
xlabel('时间/s');  
%原始信号 fft 变换  
f_true=time*Fs/length(time);  
k=fft(x,length(time));  
k(:,ceil(length(k)/2):end) = [];%去掉快速傅里叶变换对称的一半  
l=f_true*Fs/1e3;  
l(:,ceil(length(l)/2):end) = [];%去掉快速傅里叶变换对称的一半;  
subplot(2,2,2);  
plot(l,abs(k));title('原始声音信号频域图');xlabel('kHz');  
%IIR 滤波器(巴特沃斯滤波器)设计  
y1 = filter(myiir,x); % 直接使用设计好的滤波器进行滤波，filter 函数是滤波函数  
subplot(2,2,3);  
plot(time,y1);  
title('IIR 滤波器(巴特沃斯滤波器)滤波后声音信号时域波形')  
xlabel('时间/s');  
%滤波后信号 fft 变换  
f_true=time*Fs/length(time);  
k=fft(y1,length(time));  
k(:,ceil(length(k)/2):end) = [];%去掉快速傅里叶变换对称的一半  
l=f_true*Fs/1e3;  
l(:,ceil(length(l)/2):end) = [];%去掉快速傅里叶变换对称的一半  
subplot(2,2,4);  
plot(l,abs(k));title('IIR 滤波器(巴特沃斯滤波器)滤波后声音信号傅里叶变换');  
xlabel('kHz');  
%试听和写入信号  
audiowrite('D:\桌面\iir_filterDesign.wav',y1,Fs);  
# 四、结果展示
原始音频信号通过 FIR 滤波器前后波形对比如下图所示：  
![图 5 FilterDesign 实现 FIR 滤波器](https://github.com/yuzhu-like/skills-github-pages/blob/my-pages/OUT1.png)  
原始音频信号通过 IIR 滤波器前后波形对比如下图所示：  
![图 6 FilterDesign 实现 IIR 滤波器](https://github.com/yuzhu-like/skills-github-pages/blob/my-pages/OUT2.png)  
# 五、结果分析
观察图 5 可以发现滤波后原音频信号的 8kHz 以上能量较大的高频噪声已经被滤除，试听生成的音频“myfir.wav”后发现高频噪声也已经滤去，成功用实现 FilterDesign 实现 FIR 滤波器对音频信号的滤波处理。  
观察图 6 可以发现滤波后原音频信号的 8kHz 以上能量较大的高频噪声已经被滤除，试听生成的音频“myiir.wav”后发现高频噪声也已经滤去，成功用实现 FilterDesign 实现 IIR 滤波器对音频信号的滤波处理。  
IIR 滤波器和 FIR 滤波器各自有各自的优缺点，都有不同的结构和实现方法。IIR 滤波器结构简单容易实现，但是不稳定，相频响应不是完全线性相位。FIR 滤波器一般阶数较高，相频响应具有完全的线性相位，系统绝对稳定，但是线性相位结构的 FIR 滤波器结构相对比较复杂难以实现。IIR 和 FIR 滤波器实际人工设计实现起来相对比较复杂，我们可以利用MATLAB 中的滤波器设计工具箱辅助我们完成满足要求的各种滤波器，实现起来比较简单容易。
